<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>yx - libs/typed/models</title>
        <link rel="stylesheet" href="/_static/index.css">
        <link rel="stylesheet" href="/_static/pygments.css">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css" integrity="sha384-5TcZemv2l/9On385z///+d7MSYlvIEw9FuZTIdZ14vJLqWphw7e7ZPuOiCHJcFCP" crossorigin="anonymous">
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js" integrity="sha384-cMkvdD8LoxVzGF/RPUKAcvmm49FQ0oxwDF3BGKtDXcEc+T1b2N+teh/OJfpU0jr6" crossorigin="anonymous"></script>
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js" integrity="sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh" crossorigin="anonymous"></script>
        <script>
            document.addEventListener("DOMContentLoaded", function() {
                renderMathInElement(document.body, {
                  delimiters: [
                      {left: ':::tex', right: ':::', display: true},
                      {left: ':tex', right: ':', display: false},
                  ],
                  throwOnError : false
                });
            });
        </script>
    </head>     
    <body>
        <header class="header">
            <div class="menu-div">
                
                    <a href="/" class="menu-item">home</a>
                
                    <a href="/about" class="menu-item">about</a>
                
                    <a href="/education" class="menu-item">education</a>
                
                    <a href="/research" class="menu-item">research</a>
                
                    <a href="/publications" class="menu-item">publications</a>
                
                    <a href="/work" class="menu-item">work</a>
                
                    <a href="/setup" class="menu-item">setup</a>
                
                    <a href="/libs" class="menu-item">libs</a>
                
                    <a href="/notes" class="menu-item">notes</a>
                
            </div>    
        </header>
        <div style="display: flex;">
            <main class="main"><section id="models">
<h1>Models<a class="headerlink" href="#models" title="Link to this heading"></a></h1>
<p>You can create <code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">models</span></code> which are subclasses of the base <code class="docutils literal notranslate"><span class="pre">Json</span></code> class and can be used to quickly validate data, much as you can do with <code class="docutils literal notranslate"><span class="pre">BaseModel</span></code> in <a class="reference external" href="https://github.com/pydantic/pydantic">pydantic</a>, but following the <code class="docutils literal notranslate"><span class="pre">typed</span></code> philosophy:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span><span class="w"> </span><span class="nn">typed</span><span class="w">        </span><span class="kn">import</span> <span class="n">Int</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span> <span class="n">List</span>
<span class="linenos"> 2</span><span class="kn">from</span><span class="w"> </span><span class="nn">typed.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Model</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="n">SomeModel</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span>
<span class="linenos"> 5</span>    <span class="n">x</span><span class="o">=</span><span class="n">Str</span><span class="p">,</span>
<span class="linenos"> 6</span>    <span class="n">y</span><span class="o">=</span><span class="n">Int</span><span class="p">,</span>
<span class="linenos"> 7</span>    <span class="n">z</span><span class="o">=</span><span class="n">List</span><span class="p">(</span><span class="n">Int</span><span class="p">,</span> <span class="n">Str</span><span class="p">)</span>
<span class="linenos"> 8</span><span class="p">)</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="n">json</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos">11</span>    <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span>
<span class="linenos">12</span>    <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span>
<span class="linenos">13</span>    <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;foobar&#39;</span><span class="p">]</span>
<span class="linenos">14</span><span class="p">}</span>
</pre></div>
</div>
<p>With the above, <code class="docutils literal notranslate"><span class="pre">isinstance(json,</span> <span class="pre">SomeModel)</span></code> returns <code class="docutils literal notranslate"><span class="pre">False</span></code>, since <code class="docutils literal notranslate"><span class="pre">y</span></code> is expected to be an integer. As a consequence, if you use that in a <code class="docutils literal notranslate"><span class="pre">typed</span> <span class="pre">function</span></code>, this will raise a <code class="docutils literal notranslate"><span class="pre">TypeError</span></code>, as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span><span class="w"> </span><span class="nn">typed</span><span class="w"> </span><span class="kn">import</span> <span class="n">typed</span><span class="p">,</span> <span class="n">SomeType</span>
<span class="linenos"> 2</span><span class="kn">from</span><span class="w"> </span><span class="nn">some.where</span><span class="w"> </span><span class="kn">import</span> <span class="n">SomeModel</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="nd">@typed</span>
<span class="linenos"> 5</span><span class="k">def</span><span class="w"> </span><span class="nf">some_function</span><span class="p">(</span><span class="n">some_json</span><span class="p">:</span> <span class="n">SomeModel</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SomeType</span><span class="p">:</span>
<span class="linenos"> 6</span>    <span class="o">...</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="n">json</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos"> 9</span>    <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span>
<span class="linenos">10</span>    <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span>
<span class="linenos">11</span>    <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;foobar&#39;</span><span class="p">]</span>
<span class="linenos">12</span><span class="p">}</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="n">some_function</span><span class="p">(</span><span class="n">json</span><span class="p">)</span> <span class="c1"># a raise descriptive TypeError</span>
</pre></div>
</div>
</section>
<section id="validation">
<h1>Validation<a class="headerlink" href="#validation" title="Link to this heading"></a></h1>
<p>You can validade a model entity before calling it in a typed function using the <code class="docutils literal notranslate"><span class="pre">Instance</span></code> checker:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span><span class="w"> </span><span class="nn">typed</span><span class="w">        </span><span class="kn">import</span> <span class="n">typed</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span> <span class="n">List</span>
<span class="linenos"> 2</span><span class="kn">from</span><span class="w"> </span><span class="nn">typed.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Model</span><span class="p">,</span> <span class="n">Instance</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="n">Model1</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span>
<span class="linenos"> 5</span>    <span class="n">arg1</span><span class="o">=</span><span class="n">Str</span><span class="p">,</span>
<span class="linenos"> 6</span>    <span class="n">arg2</span><span class="o">=</span><span class="n">Int</span><span class="p">,</span>
<span class="linenos"> 7</span>    <span class="n">arg3</span><span class="o">=</span><span class="n">List</span><span class="p">(</span><span class="n">Int</span><span class="p">,</span> <span class="n">Str</span><span class="p">)</span>
<span class="linenos"> 8</span><span class="p">)</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="n">json1</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos">11</span>    <span class="s1">&#39;arg1&#39;</span><span class="p">:</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span>
<span class="linenos">12</span>    <span class="s1">&#39;arg2&#39;</span><span class="p">:</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span>
<span class="linenos">13</span>    <span class="s1">&#39;arg3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;foobar&#39;</span><span class="p">]</span>
<span class="linenos">14</span><span class="p">}</span>
<span class="linenos">15</span>
<span class="linenos">16</span><span class="n">model1_instance</span> <span class="o">=</span> <span class="n">Instance</span><span class="p">(</span>
<span class="linenos">17</span>    <span class="n">model</span><span class="o">=</span><span class="n">Model1</span><span class="p">,</span>
<span class="linenos">18</span>    <span class="n">entity</span><span class="o">=</span><span class="n">json1</span>
<span class="linenos">19</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><p>Such a validation is better than using just <code class="docutils literal notranslate"><span class="pre">isinstance(entity,</span> <span class="pre">model)</span></code> because it parses the <code class="docutils literal notranslate"><span class="pre">entity</span></code> and provides specific errors, while <code class="docutils literal notranslate"><span class="pre">isinstance</span></code> just return a boolean value.</p>
</div></blockquote>
<p>Another way to validate an instance is to call it directly as an argument for some <code class="docutils literal notranslate"><span class="pre">model</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">model1_instance</span> <span class="o">=</span> <span class="n">Model1</span><span class="p">({</span>
<span class="linenos">2</span>    <span class="s1">&#39;arg1&#39;</span><span class="p">:</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span>
<span class="linenos">3</span>    <span class="s1">&#39;arg2&#39;</span><span class="p">:</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span>
<span class="linenos">4</span>    <span class="s1">&#39;arg3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;foobar&#39;</span><span class="p">]</span>
<span class="linenos">5</span><span class="p">})</span>
</pre></div>
</div>
<p>You can also use a <code class="docutils literal notranslate"><span class="pre">kwargs</span></code> approach:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">model1_instance</span> <span class="o">=</span> <span class="n">Model1</span><span class="p">({</span>
<span class="linenos">2</span>    <span class="n">arg1</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span>
<span class="linenos">3</span>    <span class="n">arg2</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span>
<span class="linenos">4</span>    <span class="n">arg3</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;foobar&#39;</span><span class="p">]</span>
<span class="linenos">5</span><span class="p">})</span>
</pre></div>
</div>
<blockquote>
<div><p>Notice that you can also use the above approaches to <strong>create</strong> valid instances and not only to validate <strong>already existing</strong> instances.</p>
</div></blockquote>
</section>
<section id="exact-models">
<h1>Exact Models<a class="headerlink" href="#exact-models" title="Link to this heading"></a></h1>
<p>In <a class="reference external" href="https://github.com/pydantic/pydantic">pydantic</a>, a model created from <code class="docutils literal notranslate"><span class="pre">BaseModel</span></code> do a strict validation: a json data is considered an instance of the model iff it exactly matches the non-optional entries.  In <code class="docutils literal notranslate"><span class="pre">typed</span></code> , the <code class="docutils literal notranslate"><span class="pre">Model</span></code> factory creates subtypes of <code class="docutils literal notranslate"><span class="pre">Json</span></code>, so that a typical type checking will only evaluate if a json data <strong>contains</strong> the data defined in the model obtained from <code class="docutils literal notranslate"><span class="pre">Model</span></code>. So, for example, the following will not raise a <code class="docutils literal notranslate"><span class="pre">TypeError</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span><span class="w"> </span><span class="nn">typed</span><span class="w">        </span><span class="kn">import</span> <span class="n">typed</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span> <span class="n">List</span>
<span class="linenos"> 2</span><span class="kn">from</span><span class="w"> </span><span class="nn">typed.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Model</span><span class="p">,</span> <span class="n">Instance</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="n">Model1</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span>
<span class="linenos"> 5</span>    <span class="n">arg1</span><span class="o">=</span><span class="n">Str</span><span class="p">,</span>
<span class="linenos"> 6</span>    <span class="n">arg2</span><span class="o">=</span><span class="n">Int</span><span class="p">,</span>
<span class="linenos"> 7</span>    <span class="n">arg3</span><span class="o">=</span><span class="n">List</span><span class="p">(</span><span class="n">Int</span><span class="p">,</span> <span class="n">Str</span><span class="p">)</span>
<span class="linenos"> 8</span><span class="p">)</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="n">json2</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos">11</span>    <span class="s1">&#39;arg1&#39;</span><span class="p">:</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span>
<span class="linenos">12</span>    <span class="s1">&#39;arg2&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
<span class="linenos">13</span>    <span class="s1">&#39;arg3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;foobar&#39;</span><span class="p">]</span>
<span class="linenos">14</span>    <span class="s1">&#39;arg4&#39;</span><span class="p">:</span> <span class="s1">&#39;bar&#39;</span>
<span class="linenos">15</span><span class="p">}</span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="n">model1_instance</span> <span class="o">=</span> <span class="n">Instance</span><span class="p">(</span>
<span class="linenos">18</span>    <span class="n">model</span><span class="o">=</span><span class="n">Model1</span><span class="p">,</span>
<span class="linenos">19</span>    <span class="n">entity</span><span class="o">=</span><span class="n">json2</span>
<span class="linenos">20</span><span class="p">)</span>
</pre></div>
</div>
<p>For an exact evaluation, as occurs while using <code class="docutils literal notranslate"><span class="pre">BaseModel</span></code>, you could use the <code class="docutils literal notranslate"><span class="pre">Exact</span></code> factory from <code class="docutils literal notranslate"><span class="pre">typed.models</span></code>. It also provides a <code class="docutils literal notranslate"><span class="pre">Optional</span></code> directive, as in <a class="reference external" href="https://github.com/pydantic/pydantic">pydantic</a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span><span class="w"> </span><span class="nn">typed</span><span class="w">        </span><span class="kn">import</span> <span class="n">typed</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span> <span class="n">List</span>
<span class="linenos"> 2</span><span class="kn">from</span><span class="w"> </span><span class="nn">typed.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">ExactModel</span><span class="p">,</span> <span class="n">Instance</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="n">Model1</span> <span class="o">=</span> <span class="n">ExactModel</span><span class="p">(</span>
<span class="linenos"> 5</span>    <span class="n">arg1</span><span class="o">=</span><span class="n">Str</span><span class="p">,</span>
<span class="linenos"> 6</span>    <span class="n">arg2</span><span class="o">=</span><span class="n">Optional</span><span class="p">(</span><span class="n">Int</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>  <span class="c1"># optional entries always expect a default value</span>
<span class="linenos"> 7</span>    <span class="n">arg3</span><span class="o">=</span><span class="n">List</span><span class="p">(</span><span class="n">Int</span><span class="p">,</span> <span class="n">Str</span><span class="p">)</span>
<span class="linenos"> 8</span><span class="p">)</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="n">Model2</span> <span class="o">=</span> <span class="n">ExactModel</span><span class="p">(</span>
<span class="linenos">11</span>    <span class="n">arg1</span><span class="o">=</span><span class="n">Str</span><span class="p">,</span>
<span class="linenos">12</span>    <span class="n">arg2</span><span class="o">=</span><span class="n">Int</span><span class="p">,</span>
<span class="linenos">13</span>    <span class="n">arg3</span><span class="o">=</span><span class="n">List</span><span class="p">(</span><span class="n">Int</span><span class="p">,</span> <span class="n">Str</span><span class="p">)</span>
<span class="linenos">14</span><span class="p">)</span>
<span class="linenos">15</span>
<span class="linenos">16</span><span class="n">json1</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos">17</span>    <span class="s1">&#39;arg1&#39;</span><span class="p">:</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span>
<span class="linenos">18</span>    <span class="s1">&#39;arg3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;foobar&#39;</span><span class="p">]</span>
<span class="linenos">19</span><span class="p">}</span>
<span class="linenos">20</span>
<span class="linenos">21</span><span class="n">json2</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos">22</span>    <span class="s1">&#39;arg1&#39;</span><span class="p">:</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span>
<span class="linenos">23</span>    <span class="s1">&#39;arg2&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
<span class="linenos">24</span>    <span class="s1">&#39;arg3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;foobar&#39;</span><span class="p">]</span>
<span class="linenos">25</span><span class="p">}</span>
<span class="linenos">26</span>
<span class="linenos">27</span><span class="c1"># will NOT raise a TypeError</span>
<span class="linenos">28</span><span class="n">model1_instance</span> <span class="o">=</span> <span class="n">Instance</span><span class="p">(</span>
<span class="linenos">29</span>    <span class="n">model</span><span class="o">=</span><span class="n">Model1</span><span class="p">,</span>
<span class="linenos">30</span>    <span class="n">entity</span><span class="o">=</span><span class="n">json1</span>
<span class="linenos">31</span><span class="p">)</span>
<span class="linenos">32</span>
<span class="linenos">33</span><span class="c1"># will NOT raise a TypeError</span>
<span class="linenos">34</span><span class="n">model2_instance</span> <span class="o">=</span> <span class="n">Instance</span><span class="p">(</span>
<span class="linenos">35</span>    <span class="n">model</span><span class="o">=</span><span class="n">Model2</span><span class="p">,</span>
<span class="linenos">36</span>    <span class="n">entity</span><span class="o">=</span><span class="n">json2</span>
<span class="linenos">37</span><span class="p">)</span>
<span class="linenos">38</span>
<span class="linenos">39</span><span class="c1"># WILL raise a TypeError</span>
<span class="linenos">40</span><span class="n">model2_instance</span> <span class="o">=</span> <span class="n">Instance</span><span class="p">(</span>
<span class="linenos">41</span>    <span class="n">model</span><span class="o">=</span><span class="n">Model2</span><span class="p">,</span>
<span class="linenos">42</span>    <span class="n">entity</span><span class="o">=</span><span class="n">json1</span>
<span class="linenos">43</span><span class="p">)</span>
</pre></div>
</div>
</section>
</main>
            
            
            <div class="sidebar">
                <h3>libs menu</h3>
                <ul>
                    
                        
    <li class="">
        
            <a href="/libs/app">app</a>
        
        
            <ul>
                
                    
    <li class="">
        
            <a href="/libs/app/app">app system</a>
        
        
    </li>

                
                    
    <li class="">
        
            <a href="/libs/app/component">component system</a>
        
        
    </li>

                
            </ul>
        
    </li>

                    
                        
    <li class="">
        
            <a href="/libs/cli">cli</a>
        
        
    </li>

                    
                        
    <li class="">
        
            <a href="/libs/typed">typed</a>
        
        
            <ul>
                
                    
    <li class="">
        
            <a href="/libs/typed/models">Models</a>
        
        
    </li>

                
                    
    <li class="">
        
            <a href="/libs/typed/types">types</a>
        
        
    </li>

                
            </ul>
        
    </li>

                    
                        
    <li class="">
        
            <a href="/libs/utils">utils</a>
        
        
    </li>

                    
                </ul>
            </div>
            
        </div>
        <footer class="footer">
            <p class="footer-text">
                Yuri Ximenes, 2025. Last update: <purple>2025/07/25 at 14:30</purple><br>
                Made using <a href="https://www.sphinx-doc.org/en/master/">sphinx</a>
            </p>
        </footer>
    </body>  
</html>